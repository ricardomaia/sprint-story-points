<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Story Points Calculator</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <meta name="theme-color" content="#4a90e2">
    <link rel="manifest" href="/manifest.json">

    <!-- TailwindCSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2/dist/tailwind.min.css" rel="stylesheet">
    <script>
        window.addEventListener('error', function (e) {
            if (e.target.tagName === 'LINK' && e.target.href.includes('tailwindcss')) {
                const link = document.createElement('link');
                link.href = 'https://unpkg.com/tailwindcss@2/dist/tailwind.min.css';
                link.rel = 'stylesheet';
                document.head.appendChild(link);
            }
        }, true);
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #f5f5f5;
        }

        .app-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 20px;
        }

        .input-range {
            width: 100%;
            margin: 10px 0;
        }

        .select,
        .input-number {
            width: 100%;
            padding: 8px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin: 10px 0;
        }

        .results {
            background-color: #f8fafc;
            border-radius: 8px;
            padding: 16px;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>

    <script>
        window.addEventListener('load', function () {
            const { useState, useEffect } = React;

            function StoryPointsCalculator() {
                const [hoursPerWeek, setHoursPerWeek] = useState(20);
                const [experienceLevel, setExperienceLevel] = useState('intermediate');
                const [efficiency, setEfficiency] = useState(80);
                const [results, setResults] = useState({
                    effectiveHours: 0,
                    maxStoryPoints: 0,
                    recommendedDistribution: [],
                });

                const efficiencyMultipliers = {
                    junior: 0.7,
                    intermediate: 1.0,
                    senior: 1.3,
                };

                const storyPointReference = {
                    1: 2,
                    2: 4,
                    3: 6,
                    5: 10,
                    8: 16,
                    13: 26
                };

                const calculateStoryPoints = () => {
                    const effectiveHours = hoursPerWeek * (efficiency / 100);
                    const adjustedHours = effectiveHours * efficiencyMultipliers[experienceLevel];

                    let distribution = [];
                    let remainingHours = adjustedHours;

                    for (const [points, time] of Object.entries(storyPointReference).reverse()) {
                        const count = Math.floor(remainingHours / time);
                        if (count > 0) {
                            distribution.push({ points: parseInt(points), count });
                            remainingHours -= count * time;
                        }
                    }

                    const maxPoints = distribution.reduce((acc, curr) => acc + (curr.points * curr.count), 0);

                    setResults({
                        effectiveHours,
                        maxStoryPoints: maxPoints,
                        recommendedDistribution: distribution,
                    });
                };

                useEffect(() => {
                    calculateStoryPoints();
                }, [hoursPerWeek, experienceLevel, efficiency]);

                return React.createElement('div', { className: 'app-container' },
                    React.createElement('div', { className: 'card' },
                        React.createElement('h1', { className: 'text-2xl font-bold mb-4' }, 'Story Points Calculator'),

                        React.createElement('div', {
                            className: 'bg-blue-50 text-sm text-gray-700 border border-blue-200 rounded-md p-4 mb-4'
                        },
                            React.createElement('p', { className: 'mb-2' }, 'Esta ferramenta ajuda freelancers e equipes autogerenciadas a estimar o número máximo de Story Points que um desenvolvedor pode assumir por semana.'),
                            React.createElement('ul', { className: 'list-disc pl-5 space-y-1' }, [
                                React.createElement('li', { key: 1 }, 'Ajuste o número de horas disponíveis por semana.'),
                                React.createElement('li', { key: 2 }, 'Escolha o nível de experiência do desenvolvedor.'),
                                React.createElement('li', { key: 3 }, 'Ajuste a eficiência (% do tempo efetivamente produtivo).'),
                                React.createElement('li', { key: 4 }, 'Veja a estimativa de pontos possíveis com uma distribuição recomendada.')
                            ])
                        ),

                        React.createElement('div', { className: 'space-y-4' },
                            React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-medium mb-1' }, 'Horas por Semana'),
                                React.createElement('input', {
                                    type: 'range', min: '4', max: '40', value: hoursPerWeek,
                                    onChange: (e) => setHoursPerWeek(parseInt(e.target.value)),
                                    className: 'input-range'
                                }),
                                React.createElement('div', { className: 'text-sm text-gray-500' }, `${hoursPerWeek} horas`)
                            ),

                            React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-medium mb-1' }, 'Eficiência (%)'),
                                React.createElement('input', {
                                    type: 'number', min: '10', max: '100', step: '1', value: efficiency,
                                    onChange: (e) => setEfficiency(parseInt(e.target.value)),
                                    className: 'input-number'
                                })
                            ),

                            React.createElement('div', null,
                                React.createElement('label', { className: 'block text-sm font-medium mb-1' }, 'Nível de Experiência'),
                                React.createElement('select', {
                                    value: experienceLevel,
                                    onChange: (e) => setExperienceLevel(e.target.value),
                                    className: 'select'
                                },
                                    React.createElement('option', { value: 'junior' }, 'Junior'),
                                    React.createElement('option', { value: 'intermediate' }, 'Intermediário'),
                                    React.createElement('option', { value: 'senior' }, 'Senior')
                                )
                            ),

                            React.createElement('div', { className: 'results' },
                                React.createElement('h2', { className: 'text-lg font-semibold mb-3' }, 'Resultados'),
                                React.createElement('div', { className: 'space-y-2' },
                                    React.createElement('p', null, `Horas efetivas por semana: ${results.effectiveHours.toFixed(1)}h`),
                                    React.createElement('p', null, `Máximo de Story Points: ${results.maxStoryPoints}`),
                                    React.createElement('div', { className: 'mt-4' },
                                        React.createElement('p', { className: 'font-medium mb-2' }, 'Distribuição Recomendada:'),
                                        results.recommendedDistribution.map((item, index) =>
                                            React.createElement('p', { key: index }, `${item.count}x tarefas de ${item.points} pontos`)
                                        )
                                    )
                                )
                            )
                        )
                    )
                );
            }

            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(React.createElement(StoryPointsCalculator));
        });
    </script>

    <!-- Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('ServiceWorker registered');
                }).catch(error => {
                    console.log('ServiceWorker registration failed:', error);
                });
            });
        }
    </script>
</body>

</html>